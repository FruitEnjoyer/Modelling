(* ::Package:: *)

(* ::Input:: *)
(*(*\:0441\:043d\:0430\:0447\:0430\:043b\:0430 \:043f\:043e\:0434\:0433\:0440\:0443\:0436\:0443 \:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:044f \:041d\:0430\:0432\:044c\:0435-\:0421\:0442\:043e\:043a\:0441\:0430 \:0434\:043b\:044f \:0432\:044f\:0437\:043a\:043e\:0439 \:043d\:0435\:0441\:0436\:0438\:043c\:0430\:0435\:043c\:043e\:0439 \:0436\:0438\:0434\:043a\:043e\:0441\:0442\:0438 \:0438\:0437 \:0431\:0438\:0431\:043b\:0438\:043e\:0442\:0435\:043a\:0438 Mathematica*)*)
(*(*\:041f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:044b\:0435 u \:0438 v \:043e\:0431\:043e\:0437\:043d\:0430\:0447\:0430\:044e\:0442 \:0441\:043e\:043e\:0442\:0432\:0435\:0442\:0441\:0442\:0432\:0435\:043d\:043d\:043e \:0441\:043a\:043e\:0440\:043e\:0441\:0442\:044c \:0442\:0435\:0447\:0435\:043d\:0438\:044f \:043f\:043e \:043e\:0441\:044f\:043c x \:0438 y, p - \:0434\:0430\:0432\:043b\:0435\:043d\:0438\:0435 \:0432 \:0436\:0438\:0434\:043a\:043e\:0441\:0442\:0438*)*)
(*op={Inactive[Div][({{-mu,0},{0,-mu}}.Inactive[Grad][u[x,y],{x,y}]),{x,y}]+\!\(\*SuperscriptBox[\(p\), *)
(*TagBox[*)
(*RowBox[{"(", *)
(*RowBox[{"1", ",", "0"}], ")"}],*)
(*Derivative],*)
(*MultilineFunction->None]\)[x,y],Inactive[Div][({{-mu,0},{0,-mu}}.Inactive[Grad][v[x,y],{x,y}]),{x,y}]+\!\(\*SuperscriptBox[\(p\), *)
(*TagBox[*)
(*RowBox[{"(", *)
(*RowBox[{"0", ",", "1"}], ")"}],*)
(*Derivative],*)
(*MultilineFunction->None]\)[x,y],\!\(\*SuperscriptBox[\(u\), *)
(*TagBox[*)
(*RowBox[{"(", *)
(*RowBox[{"1", ",", "0"}], ")"}],*)
(*Derivative],*)
(*MultilineFunction->None]\)[x,y]+\!\(\*SuperscriptBox[\(v\), *)
(*TagBox[*)
(*RowBox[{"(", *)
(*RowBox[{"0", ",", "1"}], ")"}],*)
(*Derivative],*)
(*MultilineFunction->None]\)[x,y]}/.mu->1;*)
(*pde=op=={0,0,0};*)
(**)
(**)
(*(*\:0421\:043e\:0437\:0434\:0430\:043c \:0440\:0430\:0441\:0447\:0435\:0442\:043d\:0443\:044e \:043e\:0431\:043b\:0430\:0441\:0442\:044c. \:0422\:0430\:043a\:0430\:044f \:0433\:0435\:043e\:043c\:0435\:0442\:0440\:0438\:044f \:0432\:044b\:0431\:0440\:0430\:043d\:0430 \:0438\:0441\:0445\:043e\:0434\:044f \:0438\:0437 \:043f\:043e\:0434\:043e\:0431\:043d\:043e\:0439 \:0437\:0430\:0434\:0430\:0447\:0438 \:0432 \:043a\:0443\:0440\:0441\:0435 FlowVision, \:043a\:043e\:0442\:043e\:0440\:044b\:0439 \:043c\:044b \:0438\:0437\:0443\:0447\:0430\:0435\:043c \:0432 \:044d\:0442\:043e\:043c \:0441\:0435\:043c\:0435\:0441\:0442\:0440\:0435*)*)
(*reg=RegionDifference[*)
(*Rectangle[{0,0},{2,1/2}],*)
(*RegionUnion[*)
(*Rectangle[{0.98,0.},{1.02,0.15}],*)
(*Rectangle[{0.98,0.35},{1.02,0.5}]*)
(*]*)
(*];*)
(*(*\:0412\:0438\:0437\:0443\:0430\:043b\:044c\:043d\:043e \:043e\:0446\:0435\:043d\:044e \:043e\:0431\:043b\:0430\:0441\:0442\:044c:*)*)
(*RegionPlot[reg,AspectRatio->Automatic]*)
(**)
(**)
(*(*\:0417\:0430\:0434\:0430\:043c \:0433\:0440\:0430\:043d\:0438\:0447\:043d\:044b\:0435 \:0443\:0441\:043b\:043e\:0432\:0438\:044f \:0437\:0430\:0434\:0430\:0447\:0438. \:0418\:0445 3 \:0448\:0442\:0443\:043a\:0438:*)
(*\:041f\:0435\:0440\:0432\:043e\:0435 - \:0437\:0430\:0434\:0430\:044e \:0441\:043a\:043e\:0440\:043e\:0441\:0442\:044c \:043f\:043e\:0442\:043e\:043a\:0430 \:043d\:0430 \:0432\:0445\:043e\:0434\:0435 \:0432 \:0442\:0440\:0443\:0431\:0443,*)
(*\:0412\:0442\:043e\:0440\:043e\:0435 - \:043d\:0430 \:0441\:0442\:0435\:043d\:043a\:0430\:0445 \:0442\:0440\:0443\:0431\:044b \:0437\:0430\:0434\:0430\:044e \:043f\:0440\:0438\:043b\:0438\:043f\:0430\:043d\:0438\:0435 \:0447\:0430\:0441\:0442\:0438\:0446,*)
(*\:0422\:0440\:0435\:0442\:044c\:0435 - \:0443\:0441\:043b\:043e\:0432\:0438\:0435 \:0441\:0432\:043e\:0431\:043e\:0434\:043d\:043e\:0433\:043e \:0432\:044b\:0445\:043e\:0434\:0430 \:0436\:0438\:0434\:043a\:043e\:0441\:0442\:0438 - \:043d\:0443\:043b\:0435\:0432\:043e\:0435 \:0434\:0430\:0432\:043b\:0435\:043d\:0438\:0435.*)
(**)*)
(*bcs={*)
(*DirichletCondition[u[x,y]==4*0.3*y*(0.5-y)/(0.41)^2,x==0.],DirichletCondition[{u[x,y]==0.,v[x,y]==0.},0<x<2],*)
(*DirichletCondition[p[x,y]==0.,x== 2]*)
(*};*)
(**)
(**)
(*(*\:0412\:0441\:0435 \:0437\:0430\:043f\:0438\:0441\:0430\:043d\:043d\:044b\:0435 \:0443\:0441\:043b\:043e\:0432\:0438\:044f \:0438\:0441\:043f\:043e\:043b\:044c\:0437\:0443\:044e \:0432 \:0440\:0435\:0448\:0430\:0442\:0435\:043b\:0435 \:0414\:0423 \:0438 \:043f\:043e\:043b\:0443\:0447\:0430\:044e \:0438\:043d\:0442\:0435\:0440\:043f\:043e\:043b\:0438\:0440\:043e\:0432\:0430\:043d\:043d\:044b\:0435 \:0444\:0443\:043d\:043a\:0446\:0438\:0438 \:0441\:043a\:043e\:0440\:043e\:0441\:0442\:0438 \:0438 \:0434\:0430\:0432\:043b\:0435\:043d\:0438\:044f.*)
(*\:0412 \:043f\:0430\:0440\:0430\:043c\:0435\:0442\:0440\:0430\:0445 \:0444\:0443\:043d\:043a\:0446\:0438\:0438 \:0437\:0430\:0434\:0430\:044e \:043c\:0435\:0442\:043e\:0434 \:0440\:0435\:0448\:0435\:043d\:0438\:044f, \:043f\:043e\:0440\:044f\:0434\:043e\:043a \:0442\:043e\:0447\:043d\:043e\:0441\:0442\:0438 \:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:044b\:0445 \:0438 \:043c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:044c\:043d\:044b\:0439 \:0440\:0430\:0437\:043c\:0435\:0440 \:044f\:0447\:0435\:0439\:043a\:0438 \:0441\:0435\:0442\:043a\:0438 (\:0441\:0435\:0442\:043a\:0430 \:0441\:043e\:0437\:0434\:0430\:0435\:0442\:0441\:044f \:0430\:0432\:0442\:043e\:043c\:0430\:0442\:0438\:0447\:0435\:0441\:043a\:0438 \:043d\:0430 \:044d\:0442\:043e\:043c \:044d\:0442\:0430\:043f\:0435)*)
(**)*)
(*{xVel,yVel,pressure}=NDSolveValue[{op=={0,0,0},bcs},{u,v,p},{x,y}\[Element]reg,Method->{"FiniteElement","InterpolationOrder"->{u->2,v->2,p->1},"MeshOptions"->{"MaxCellMeasure"->0.0001}}];*)
(**)
(**)
(*(*\:0414\:0423 \:0440\:0435\:0448\:0435\:043d\:043e, \:0434\:0430\:043b\:044c\:0448\:0435 \:0442\:043e\:043b\:044c\:043a\:043e \:0432\:0438\:0437\:0443\:0430\:043b\:0438\:0437\:0430\:0446\:0438\:044f \:0440\:0435\:0437\:0443\:043b\:044c\:0442\:0430\:0442\:043e\:0432!*)*)
(**)
(**)
(*(*\:0413\:0440\:0430\:0444\:0438\:043a \:043c\:043e\:0434\:0443\:043b\:044f \:0441\:043a\:043e\:0440\:043e\:0441\:0442\:0438*)*)
(*DensityPlot[Sqrt[xVel[x,y]^2+yVel[x,y]^2],{x,y}\[Element]reg,AspectRatio->Automatic,ColorFunction->"TemperatureMap",PlotLegends->Automatic,PlotPoints->100]*)
(**)
(**)
(*(*\:0413\:0440\:0430\:0444\:0438\:043a \:0434\:0430\:0432\:043b\:0435\:043d\:0438\:044f*)*)
(*DensityPlot[pressure[x,y],{x,y}\[Element]reg,AspectRatio->Automatic,ColorFunction->"TemperatureMap",PlotLegends->Automatic,PlotPoints->100,Mesh->31,MeshFunctions->{#3&},MeshStyle->{Black,Thickness[0.0008]}]*)
(**)
(**)
(*(*\:0412\:0435\:043a\:0442\:043e\:0440\:043d\:043e\:0435 \:043f\:043e\:043b\:0435 \:0441\:043a\:043e\:0440\:043e\:0441\:0442\:0435\:0439*)*)
(*Show[{*)
(*RegionPlot[reg,AspectRatio->Automatic],*)
(*StreamPlot[{xVel[x,y], yVel[x,y]},{x,y}\[Element]reg, AspectRatio->Automatic,StreamPoints->Fine,StreamStyle->{Black,Thin}]*)
(*}]*)
